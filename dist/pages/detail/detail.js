"use strict";require(["../../static/conf/config.js"],function(){require(["jquery","lodash"],function(i,n){var o=JSON.parse(sessionStorage.getItem("loginUser"));o&&i(".isLogin").html("<li>".concat(o.tel,'</li><li><a href="#" class="loginOut">退出</a></li>'));var t=JSON.parse(localStorage.getItem("cart"));console.log(t);var e=n.template(i("#cartSmall").text())({data:t});console.log(e),i("#cart_content").html(e);e=n.template(i("#cartBig").text())({data:t});console.log(e),i(".productBox").html(e),i(".bigCartExtend").click(function(){i(".bigCart").show()}),i(".close").click(function(){i(".bigCart").hide()}),i(".shopCar").mouseenter(function(){i(".shopCartBox").show(),console.log("进来了")}),i(".shopCar").mouseleave(function(){i(".shopCartBox").hide()}),i(".loginOut").click(function(){i(".isLogin").html('<li><a href="../login/login.html">请登录</a></li><li><a href="../regist/regist.html">快速注册</a></li>'),sessionStorage.removeItem("loginUser")}),i(".jumei").mouseover(function(){i(this).children(".sub_nav").show(),i(this).children("a").children("em").removeClass("icon-icon-arrowdown-expa").addClass("icon-icon-arrowup")}),i(".jumei").mouseout(function(){i(this).children(".sub_nav").hide(),i(this).children("a").children("em").removeClass("icon-icon-arrowup").addClass("icon-icon-arrowdown-expa")}),i(".mzStore").mouseover(function(){i(".mzStore em").removeClass("icon-icon-arrowdown-expa").addClass("icon-icon-arrowup"),i(".mzsc").show()}),i(".mzStore").mouseout(function(){var o=!0,t=setTimeout(function(){i(".mzsc").mouseover(function(){clearTimeout(t),o=!1}),i(".mzsc").mouseout(function(){i(".mzStore em").removeClass("icon-icon-arrowup").addClass("icon-icon-arrowdown-expa"),i(".mzsc").hide()}),o&&(i(".mzStore em").removeClass("icon-icon-arrowup").addClass("icon-icon-arrowdown-expa"),i(".mzsc").hide())},1e3)});var a=sessionStorage.getItem("productAccount");null==a&&(a=0),i(".cart_num").html("".concat(a)),console.log("http://localhost:8000/detail".concat(window.location.search)),i.ajax({type:"GET",url:"http://localhost:8000/detail".concat(window.location.search),dataType:"json",success:function(o){console.log("开始了");var t=n.template(i("#temp_product").text())({data:o.data});i(".topMenu").html(t);var e=i("#pidHiddle").attr("no"),a=JSON.parse(localStorage.getItem("cart")),c=0;a.forEach(function(o){c+=o.count}),console.log(c),console.log(i(".cart_num")),localStorage.setItem("productAccount",c),i(".cart_num").html(c.toString()),i.ajax({type:"GET",url:"http://localhost:8000/suggest?pid=".concat(e),dataType:"json",success:function(o){console.log("开始了");var t=n.template(i("#suggestTemp").text())({data:o});i("#suggestOpt").html(t),i(".proAdd:last").remove(),i(".ULPrice a").text("￥".concat(i(".currentPrice").text())),i("#go_to_cart").click(function(){console.log("加入购物车");var o=i('<div id="ball"></div>');o.css({left:i(this).offset().left+91,top:i(this).offset().top-20}),i(document.body).append(o),function(t,e){var a={x:t.offset().left,y:t.offset().top},c={x:e.offset().left-a.x,y:a.y-e.offset().top},n=-.0015,s=(c.y-n*c.x*c.x)/c.x,l=0,r=setInterval(function(){l+=8,t.css({left:l+a.x});var o=n*l*l+s*l;t.css({top:a.y-o}),c.x<=l&&(t.css({left:e.offset().left,top:e.offset().top}),clearInterval(r),t.remove(),i(".cart_num").html(parseInt(i(".cart_num").html())+1))},20)}(o,i("#liCart")),console.log(i(".proInfo").html());var t=JSON.parse(i(".proInfo").html());console.log(t);var e=JSON.parse(localStorage.getItem("cart")),a=localStorage.getItem("productAccount");null==a&&(a=0),a++;var c=[],n=!1;e&&e.forEach(function(o){o.pid!=t.pid||(n=!0,o.count++),c.push(o)}),n||c.push(t),localStorage.setItem("cart",JSON.stringify(c)),localStorage.setItem("productAccount",a)}),i.ajax({type:"GET",url:"http://localhost:8000/test".concat(window.location.search),dataType:"html",success:function(o){console.log("详情开始了");o.match(/<img[^>]*>/gi).forEach(function(o,t){2<=t&&i("#detailInfo").append(i(o))})}})}})}})})});